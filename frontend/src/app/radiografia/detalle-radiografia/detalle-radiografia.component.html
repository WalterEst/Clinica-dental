<app-nav-bar></app-nav-bar>

<section class="container">
  <div class="form-wrapper">
    <div class="form-header">
      <h2 class="form-title">Detalle de Radiografía</h2>
      <p class="form-subtitle">Visualiza y edita la información de la radiografía</p>
    </div>

    <form class="patient-form" [formGroup]="radiografiaForm" (ngSubmit)="onSubmit()">
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">RUT Paciente</label>
          <input class="form-input" type="text" [value]="radiografia?.rutPaciente" readonly />
        </div>

        <div class="form-group">
          <label class="form-label">Nombre Paciente</label>
          <input class="form-input" type="text" [value]="radiografia?.nombre + ' ' + radiografia?.apellido" readonly />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label" for="fecha_toma">Fecha de toma</label>
          <input class="form-input" type="date" id="fecha_toma" formControlName="fecha_toma" required />
        </div>

        <div class="form-group">
          <label class="form-label" for="tipo">Tipo</label>
          <input class="form-input" type="text" id="tipo" formControlName="tipo" placeholder="Ej: Panorámica" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group full-width">
          <label class="form-label" for="observaciones">Observaciones</label>
          <textarea
            class="form-input"
            id="observaciones"
            formControlName="observaciones"
            rows="3"
            placeholder="Ingrese observaciones"
          ></textarea>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group full-width">
          <label class="form-label" for="archivo">Archivo</label>
          <input
            class="form-input"
            type="file"
            id="archivo"
            (change)="onFileSelected($event)"
            accept="image/*,application/pdf"
          />
          <div *ngIf="radiografiaForm.value.archivo" style="margin-top: 8px;">
            <a
              [href]="backendUrl + '/' + radiografiaForm.value.archivo"
              target="_blank"
              class="submit-btn"
              style="min-width: auto; padding: 6px 12px; font-size: 14px;"
            >
              Ver archivo actual
            </a>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="submit-btn" [disabled]="radiografiaForm.invalid || cargando">Guardar cambios</button>
        <button type="button" class="submit-btn eliminar-btn" (click)="eliminarRadiografia()">Eliminar</button>
        <button type="button" class="submit-btn" (click)="cancelar()">Cancelar</button>
      </div>


      <div *ngIf="cargando" style="text-align:center; color:#555; margin-top: 15px;">
        Cargando datos...
      </div>
      <div *ngIf="errorMessage" class="mensaje-error" style="text-align:center; margin-top: 15px;">
        {{ errorMessage }}
      </div>
    </form>
  </div>
</section>

<app-footer></app-footer>
