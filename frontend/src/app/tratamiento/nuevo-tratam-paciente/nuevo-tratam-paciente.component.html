<app-nav-bar></app-nav-bar>

<section class="container">
  <div class="form-wrapper">
    <div class="form-header">
      <h2 class="form-title">Asignar Tratamiento a {{ pacienteNombre }}</h2>
      <p class="form-subtitle">{{ formatearRut(rut) }}</p>
    </div>

    <form [formGroup]="tratamientoForm" (ngSubmit)="onSubmit()" class="patient-form">

      <div class="form-row">
        <div class="form-group full-width">
          <label for="id_tratamiento" class="form-label">Tratamiento <span style="color:red">*</span></label>
          <select id="id_tratamiento" formControlName="id_tratamiento" required class="form-input">
            <option value="" disabled selected>Seleccione un tratamiento</option>
            <option *ngFor="let t of tratamientos" [value]="t.id_tratamiento">{{ t.nombre }}</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="fecha_inicio" class="form-label">Fecha de inicio <span style="color:red">*</span></label>
          <input type="date" id="fecha_inicio" formControlName="fecha_inicio" required class="form-input" />
        </div>

        <div class="form-group">
          <label for="fecha_fin" class="form-label">Fecha de fin</label>
          <input type="date" id="fecha_fin" formControlName="fecha_fin" class="form-input" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group full-width">
          <label for="descripcion" class="form-label">Descripci√≥n</label>
          <textarea id="descripcion" formControlName="descripcion" rows="3" class="form-input"></textarea>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group full-width">
          <label for="monto_aplicado" class="form-label">Monto aplicado</label>
          <input type="number" id="monto_aplicado" formControlName="monto_aplicado" step="0.01" class="form-input" />
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="submit-btn" [disabled]="tratamientoForm.invalid || loading">Guardar</button>
        <button type="button" class="submit-btn" style="background: #6c757d;" (click)="cancelar()">Cancelar</button>
      </div>

      <div *ngIf="errorMessage" style="color:red; margin-top:1em; text-align:center;">{{ errorMessage }}</div>
    </form>
  </div>
</section>

<app-footer></app-footer>
